"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var tslib_1=require("tslib"),node_fetch_1=tslib_1.__importDefault(require("node-fetch")),merge_deep_1=tslib_1.__importDefault(require("merge-deep")),url_1=require("url"),API=function(){function API(send){var base=send.base,basic=send.basic,shorthands=send.shorthands,prm=send.prm,send=send.send;this.base=base,this.basic=basic||{},this.prm=Object.fromEntries(Object.entries(prm||{}).map(function(v){var k=v[0],v=v[1];return[k.toLowerCase(),v]})),this.send=Object.fromEntries(Object.entries(send).map(function(value){var key=value[0],value=value[1];return[key,this.makeSndr(value)]}))||{},this.shorthands=shorthands}return API.prototype.makeSndr=function(name){for(var path=name.path,shorthands=name.data,data=void 0===shorthands?{}:shorthands,shorthands=name.shorthands,shorthands=void 0===shorthands?{}:shorthands,name=name.name,change=[],_i=1;_i<arguments.length;_i++)change[_i-1]=arguments[_i];function sender(){for(var content=[],_i=0;_i<arguments.length;_i++)content[_i]=arguments[_i];var accessRecursive=function(access,obj){return 0!==access.length?(null==obj[access[0]]&&(obj[access[0]]={}),accessRecursive(access.splice(0,1),obj[access[0]])):obj},keepContatenating=function(obj){for(var objs=[],_i=1;_i<arguments.length;_i++)objs[_i-1]=arguments[_i];return 0===objs.length?obj:keepContatenating.apply(void 0,tslib_1.__spreadArray([merge_deep_1.default(obj,objs[0])],objs.slice(1)))},queryParams=(data=keepContatenating.apply(void 0,tslib_1.__spreadArray([merge_deep_1.default(this.basic,this.prm[(data.method||"get").toLowerCase()],data)],change.map(function(to,obj){return access=to,to=content[obj],obj={},accessRecursive((access="string"==typeof access?[access]:access).slice(0,access.length-1),obj)[access[access.length-1]]=to,obj;var access})))).queryParams||{};return delete data.queryParams,node_fetch_1.default(""+this.base+path+(0!==Object.keys(queryParams).length?"?"+new url_1.URLSearchParams(queryParams):""),data)}change=tslib_1.__spreadArray(tslib_1.__spreadArray([],this.prm[(data.method||"get").toLowerCase()].change||[]),change);return Object.entries(tslib_1.__assign(tslib_1.__assign({},shorthands),this.shorthands)).forEach(function(value){var key=value[0],value=value[1];sender[key]=value}),null!=name&&(this.send[name]=sender),sender},API}();exports.default=API;